# yaml-language-server: $schema=https://carapace.sh/schemas/command.json
name: search
description: Search for resources to request access to.
flags:
    --all-kube-namespaces: Search Pods in every namespace
    --kind!=: Resource kind to search for (node, kube_cluster, db, app, windows_desktop, user_group, pod, secret, configmap, namespace, service, serviceaccount, kube_node, persistentvolume, persistentvolumeclaim, deployment, replicaset, statefulset, daemonset, clusterrole, role, clusterrolebinding, rolebinding, cronjob, job, certificatesigningrequest, ingress)
    --kube-cluster=: Kubernetes Cluster to search for Pods
    --kube-namespace=: Kubernetes Namespace to search for Pods
    --labels=: List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2)
    --no-all-kube-namespaces&: Search Pods in every namespace
    --query=: Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and || (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"')
    --search=: List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase")
documentation:
    command: '[AI] The `tsh request search` command is used in Tenable Security Center to initiate a search query for assets, scans, or vulnerabilities within the Tenable platform. It takes one or more keywords as an argument and returns results matching those terms. For instance, `tsh request search Vulnerability name RedHat` would return all vulnerabilities with the keyword "RedHat" in their name.'
    flag:
        all-kube-namespaces: '[AI] The `tsh request search --all-kube-namespaces` command is a part of the Tanzu Kubernetes Grid (TKG) Toolset, which is used to manage and deploy Kubernetes clusters on various infrastructure providers. This specific command is used to search for resources across all namespaces in a Tanzu Kubernetes Grid cluster using the Tanzu Service Mesh interface. The `--all-kube-namespaces` flag indicates that the search should be performed in all available namespaces within the cluster, not just the default one. This command can help operators and developers to quickly locate and manage resources spread across multiple namespaces in their Tanzu Kubernetes Grid environment.'
        kind: '[AI] `tsh request search --kind` is a command used in Tenable Security Center''s Tenable Security Highway (TSH) CLI tool. This command is for searching for specific types or kinds of assets, scans, or vulnerabilities in the SecurityCenter database. The `--kind` option specifies the type of data to search for, which can be "asset", "scan", or "vulnerability". For example, `tsh request search --kind vulnerability --filter "impact > 7"` would return a list of all vulnerabilities with an impact score greater than 7.'
        kube-cluster: '[AI] The `tsh request search --kube-cluster` command is a part of the Tanzu Service Mesh by VMware''s Tanzu CLI (tsh). This command is used to search for Kubernetes clusters that are managed by Tanzu Kubernetes Grid. It retrieves details such as cluster name, API server URL, and other relevant information associated with each managed Kubernetes cluster. The result set can be further filtered or processed using various options available with the command.'
        kube-namespace: '[AI] The `tsh request search --kube-namespace` command is a part of the Kubernetes Toolset for Shell (kubectl) under the Tab completion or Tab-completing subcommand (short form: tsh). This command is used to perform tab-completion suggestions specifically for the Kubernetes namespace field while typing a command in the terminal. It helps save time by providing accurate suggestions, reducing errors and making your interactions with the Kubernetes cluster more efficient.'
        labels: '[AI] `tsh request search --labels` is a command used in the Tenable Security Center''s Tenable Security Hub (TSH) interface for querying data related to specific labels assigned to vulnerabilities or threats in your organization''s assets. The command allows users to filter and search for items based on one or more labels, enabling efficient management and prioritization of security findings.'
        no-all-kube-namespaces: '[AI] `tsh request search` is a command used in Tanzu Service Mesh by Splunk, which is a tool for observability and traffic management in Kubernetes environments. The `--no-all-kube-namespaces` flag limits the search scope to specific namespaces instead of querying all namespaces in the cluster. This can help improve search performance and reduce noise by focusing on relevant data.'
        query: '[AI] `tsh request search --query` is a command used in the Tenable Security Center''s Tenable Security Hub (TSH) interface for querying and searching through security data, such as vulnerability scan results or log events. The `--query` flag specifies the search query itself, which can be based on various criteria like hostname, IP address, asset group, or specific security data fields. This command helps users quickly find relevant information in their Tenable Security Center environment.'
        search: '[AI] The `tsh request search --search` command is a part of Tshoot, a network troubleshooting tool from Wireshark. This command initiates a search query within Tshoot''s built-in database for packet captures, packets, or flows that match specific filters. The result set includes the corresponding capture files which can be further analyzed to identify and resolve networking issues.'

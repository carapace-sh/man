# yaml-language-server: $schema=https://carapace.sh/schemas/command.json
name: last
description: Show a listing of last logged in users
flags:
    --time-format=: show timestamps in the specified <format>
    -F, --fulltimes: print full login and logout times and dates
    -R, --nohostname: don't display the hostname field
    -V, --version: display version
    -a, --hostlast: display hostnames in the last column
    -d, --dns: translate the IP number back into a hostname
    -f, --file=: use a specific file instead of /var/log/wtmp
    -h, --help: display this help
    -i, --ip: display IP numbers in numbers-and-dots notation
    -n, --limit=: how many lines to show
    -p, --present=: display who were present at the specified time
    -s, --since=: display the lines since the specified time
    -t, --until=: display the lines until the specified time
    -w, --fullnames: display full user and domain names
    -x, --system: display system shutdown entries and run level changes
documentation:
    command: '[AI] The `last` command is a Linux utility used to display the login history of users on a system. It shows the username, login time, and duration for each session. By default, it displays the 10 most recent logins, but you can specify a different number using the `-n` option. The output can be sorted by various parameters such as user or time with the `-u` or `-t` options, respectively.'
    flag:
        dns: '[AI] The `last` command with the option `--dns` is used to display the last events in the system''s `last.dns` file, which records various network connection activities such as DNS lookup queries and responses. This option allows administrators to view these DNS-related events and analyze them for troubleshooting or security purposes. The output usually includes information like the hostname or IP address of the remote host, the local hostname or IP address, the user who initiated the connection if applicable, the time and duration of the connection, and the result of the query (success or failure).'
        file: '[AI] The `last --file` command in Unix-like operating systems is used to save the output of the last command into a file instead of displaying it on the terminal. When you use `last` without any options, it displays the system login records. But when you add `--file <filename>` option, the output will be saved into the specified file instead of being printed on the terminal. This can be useful for saving and analyzing the login records in detail at a later time.'
        fullnames: '[AI] The `last` command in Unix-based systems is used to display the system''s login history, i.e., a list of users who have recently logged in and the time of their last login. The option `--fullnames` is used with the `last` command to display the full usernames instead of abbreviated ones. For instance, if the default output shows "john", using `--fullnames` would display the full username like "john_doe". This can be useful when dealing with multiple users having similar or identical short names.'
        fulltimes: '[AI] The `last` command with the `--fulltime` option in Unix-based systems displays a detailed list of user login sessions, showing the start and end times in human-readable format (hours:minutes:seconds). This helps to provide more precise information about when each session started and ended. For instance, instead of just seeing "Wed 10:30", you would see something like "Thu Aug 25 14:28:36 2022".'
        help: '[AI] `last --help` is a command in Unix-like operating systems that displays the help or usage information for the `last` utility. The `last` command is used to display the login history of users on the system. With `--help`, it provides detailed information about how to use the command with various options, such as displaying the system message of the day (MOTD), specifying a user or range of dates, and formatting the output.'
        hostlast: '[AI] The `last` command with the option `--host <last>` in Unix-based systems is used to display the last login records for a specific host or user. The `<last>` argument specifies the name or IP address of the remote host whose login history you want to view. This can be helpful for administrators to monitor and identify suspicious activity or keep track of users who have accessed certain systems. The output will display the username, hostname or IP address, date, and time of each login session for the given host.'
        ip: '[AI] The `last --ip` command is a utility in Unix-like operating systems used to display the last login records of users on a system, with an additional option to filter by IP address. Specifically, when used with the `--ip` flag, it will display the last login records for a particular IP address, providing details such as username, login time, and login method (e.g., ssh, pty). This can be helpful in identifying when specific IP addresses accessed the system and which users were logged in during those sessions.'
        limit: '[AI] The `last` command with the `--limit` option is used in Unix-based systems to display the last N lines of a file, typically a log file. N is the number specified by the user. For instance, `last -5 /var/log/syslog` would display the last 5 lines of the syslog file. This can be helpful for quickly reviewing recent system activity or errors.'
        nohostname: '[AI] The `last` command with the option `--nohostname` is used in Unix-based systems to display the last login records without showing the hostnames of the machines from which the users logged in. This means that only the usernames and the corresponding timestamps will be displayed, providing a more concise output focused on the local system''s login history.'
        present: |-
            [AI] The `last --present` command in Unix-based systems is used to display information about the latest connection on a particular host, as well as the current connection if there is one. The `--present` option ensures that the output only shows currently connected sessions.

            When run without any arguments, it will show the last login for the current user on the local machine. With an argument specifying a remote host or username and hostname, it will display the last logins for that specific user or host.

            The output includes columns like User, Host, Last, and XUID (the exit status of the last job), providing essential details about the most recent login sessions.
        since: '[AI] The `last --since` command is a Unix utility used to display the most recent N entries in system logs that match a specified time criteria. The `--since` option specifies a time argument, which can be provided as an absolute date or relative duration from the present. For example, `last --since 3 days` would display the last entries in the system logs that occurred within the previous three days.'
        system: '[AI] The `last --system` command is a Linux utility used to display the last login records for all users on a specific system. It reads and displays the contents of the system''s /var/log/wtmp or /var/log/utmp file, which keeps track of user login sessions. By using the `--system` option, you can filter the output to show only the system logs instead of individual user logs (which is the default behavior without any options). This command helps in identifying and investigating unauthorized access attempts or system activity patterns.'
        time-format: '[AI] The `last` command in Unix or Linux is used to display the last N events, based on a given criteria, that occurred in a file (usually a system log file). The `--time-format` option specifies the format of the timestamp displayed for each event. It takes a string argument describing the desired output format. For example, `--time-format="+%Y-%m-%d %H:%M:%S"` would display timestamps as "YYYY-MM-DD HH:MM:SS". This can be useful for analyzing log files and identifying trends or anomalies based on time data.'
        until: '[AI] The `last --until` command is a Unix utility used to display the last N observations in a file that match a given condition based on their timestamp, where N is specified by the user and the condition is given by the `--until` option. This option takes a time argument which can be either an absolute date or a relative time period. The output includes the timestamps, PID (process ID), usernames, and other relevant information for each matching observation. It''s particularly useful when analyzing system logs to find recent occurrences of specific events.'
        version: '[AI] The `last --version` command is used in Unix-based systems to display the version information of the Last (or LAST) utility, which is a tool for recording and replaying terminal sessions. The command retrieves and prints out the specific version number of the Last software installed on your system, providing you with information about its release date, compilation settings, and other relevant details.'

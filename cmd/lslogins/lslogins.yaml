# yaml-language-server: $schema=https://carapace.sh/schemas/command.json
name: lslogins
description: Display information about known users in the system
flags:
    --btmp-file=: set an alternate path for btmp
    --lastlog=: set an alternate path for lastlog
    --noheadings: don't print headings
    --notruncate: don't truncate output
    --output-all: output all columns
    --time-format=: display dates in short, full or iso format
    --wtmp-file=: set an alternate path for wtmp
    -G, --supp-groups: display information about groups
    -L, --last: show info about the users' last login sessions
    -V, --version: display version
    -Z, --context: display SELinux contexts
    -a, --acc-expiration: display info about passwords expiration
    -c, --colon-separate: display data in a format similar to /etc/passwd
    -e, --export: display in an export-able output format
    -f, --failed: display data about the users' last failed logins
    -g, --groups=: display users belonging to a group in <groups>
    -h, --help: display this help
    -l, --logins=: display only users from <logins>
    -n, --newline: display each piece of information on a new line
    -o, --output=: define the columns to output
    -p, --pwd: display information related to login by password.
    -r, --raw: display in raw mode
    -s, --system-accs: display system accounts
    -u, --user-accs: display user accounts
    -z, --print0: delimit user entries with a nul character
documentation:
    command: '[AI] The `lslogins` command is a Linux utility that lists the login information of active users, including their usernames, terminal devices, and login times. It reads the system file `/var/run/utmp` or `/var/log/wtmp` (depending on the configuration) which stores login records, and displays the current entries related to users who are currently logged in.'
    flag:
        acc-expiration: '[AI] `lslogins --acc-expiration` is a command in Linux systems that lists out user accounts with their expired or soon-to-expire SSH keys from the system''s authentication logs. The `--acc-expiration` option filters the output to only show these accounts. It helps system administrators maintain security by keeping track of and managing expired or nearing-expiration SSH keys that could potentially pose a security risk if not properly managed.'
        btmp-file: '[AI] The `lslogins` command with the option `--btmp-file` is used to display the failed login attempts recorded in the Bachelor file of the System Log (auth.log or security.log). The Bachelor file stores records of unsuccessful login attempts, including the date and time, user name, hostname or IP address, and authentication method used. By specifying `--btmp-file`, the output will only display the failed login attempts instead of all entries in the log file.'
        colon-separate: '[AI] `lslogins` is a Linux command used to display a list of users and their last login information from system logs (usually /var/log/wtmp or /var/log/lastlog). The option `--colon-separated` is used to output the data in a colon-separated format, which can be easily imported into spreadsheet programs like Excel for further analysis. It displays each line as "username:last-login:logout-time:idle-time:terminal-device:authenticated" with fields separated by colons.'
        context: '[AI] `lslogins` is a command in Linux systems used to display the last login information for users, including their usernames, the terminal or IP address from which they last logged in, and the date and time of their last login. The `--context` option provides additional context information in the output, such as the hostname or operating system of the machine from which the user last logged in. This can be helpful in identifying the location or type of machine used by a particular user.'
        export: '[AI] `lslogins --export` is a command used in Linux systems to list all the system accounts that have been used for login sessions, along with relevant information such as the last login date, IP address, and number of logins. The `--export` option allows you to output this data into a file or stream it to another program, often in a delimited format like CSV for easier data processing and analysis.'
        failed: '[AI] `lslogins --failed` is a Linux command used to list the failed login attempts recorded in the system''s authentication logs. The `--failed` option filters the output to show only the failed login attempts, which may include incorrect usernames or passwords, as well as denied access due to other reasons like account lockout policies. This information can be helpful for system administrators to identify potential security threats and ensure the security of their systems.'
        groups: '[AI] `lslogins --groups` is a command in Linux used to list the system logs of failed and successful login attempts, along with the associated group names for each user. The output shows the username, terminal or IP address used to log in, the login status (success or failure), and the corresponding group name. This information can be helpful in security audits and troubleshooting issues related to unauthorized access attempts.'
        help: |-
            [AI] `lslogins --help` is a command used in Unix-like operating systems to display information about the usage of the `lslogins` utility. This command shows a brief help message that describes what `lslogins` does and how to use it effectively.

            `lslogins` is a simple shell script that lists the login sessions for users on the system, showing their current terminal or remote host, login time, and idle time. The output can be customized using various options.

            To help you get started, here are some key points from the `--help` message:

            - Displays a list of currently logged in users with their associated terminals and login times
            - Can filter the output based on username or terminal type
            - Provides options for sorting the output by various columns
            - Allows customization of the command's output using various formatting options.
        last: '[AI] The `lslogins` command with the option `--last` in Linux or Unix systems displays the most recent remote login entries in the system''s `/var/log/wtmp` or `/var/log/lastlog` file. Each line represents an individual login event, showing details like the username, hostname, and login timestamp. It helps in identifying recent system accesses from different terminals or locations.'
        lastlog: '[AI] `lslogins` is a Linux command used to list the system''s login records stored in the `/var/log/wtmp` or `/var/run/utmp` files. The `--lastlog` option filters the output to show only the most recent login record for each user. This includes the username, login timestamp, and the terminal device used for the login.'
        logins: '[AI] `lslogins` is a command in Linux and other Unix-like operating systems used to list the login sessions or shells currently active on the system. The option `--logins` specifically displays the usernames associated with each session, making it easier to identify who is logged in. This information can be useful for system administrators to manage and monitor user activity.'
        newline: '[AI] `lslogins` is a Linux command used to list the users who have recently logged into the system based on the login records stored in the system''s `/var/log/wtmp` or `/var/run/utmp` file. The `--newline` option is used to output each line separately instead of merging multiple lines into a single line when displaying the user information. This can make it easier to parse and process the output in scripts or other automated tools.'
        noheadings: '[AI] The `lslogins` command with the `--noheadings` option is used in Unix-based systems to list the login sessions, excluding column headers or headings. When you run `lslogins` without any options, it displays the current login sessions along with their corresponding TTY devices and start times, but it also shows column headers such as "tty", "login" and "idle". By adding the `--noheadings` option, only the data rows (i.e., login sessions) will be displayed without any column headers. This can make the output more concise and easier to parse when dealing with scripts or automated processes.'
        notruncate: '[AI] The `lslogins` command with the `--notruncate` option displays the last login times for users in the system''s `/var/log/wtmp` or `/var/log/lastlog` files without truncating (i.e., deleting old data) those logs. This means that all historical login information will be displayed, making it useful for administrators to investigate past login activities or analyze trends over time.'
        output: '[AI] The `lslogins` command with the `--output` option is used in Linux systems to display a list of users and their last login information from the system''s authentication logs (usually /var/log/wtmp or /var/log/lastlog). The output is customizable using the `--output` flag, which can specify different columns such as username, last login time, IP address, and more. For example, `lslogins --output=%p %u %t %T %l > logfile.txt` will save the list with columns: PID, Username, Time, Terminal device, and Login type (local or remote).'
        output-all: '[AI] The `lslogins --output-all` command is used in Linux systems to list all the successful and failed login attempts recorded in the system''s `/var/log/wtmp` or `/var/log/utmp` files. This includes details such as username, terminal device, IP address (if applicable), and timestamp for each login attempt. The `--output-all` option indicates that all available columns should be displayed.'
        print0: '[AI] `lslogins` is a Linux command used to list login sessions or users currently logged into the system. The option `--print0` is used to output each line separated by null characters instead of newlines. This allows for easier processing of the output in scripts using tools like `xargs` or `awk`. By separating lines with nulls, there''s less chance of encountering special characters within usernames or other data that might cause issues when handling the output further.'
        pwd: '[AI] The `lslogins` is a command-line utility in Unix and Linux systems that lists the login sessions managed by the System V Init daemon (sysvinit). The option `--pwd` displays the present working directory of each logged-in user. So, when you run `lslogins --pwd`, it shows the usernames along with their current working directories. This information can be helpful for system administrators in troubleshooting or monitoring user activities.'
        raw: '[AI] `lslogins --raw` is a command in Linux that displays a list of users and their corresponding login details from the system''s `/var/log/wtmp` or `/var/log/utmp` files. The `--raw` option is used to display the output in an unformatted manner, where each line represents a single login event, with columns for the username, TTY device, login time, and other relevant information.'
        supp-groups: '[AI] `lslogins` is a command in Linux systems used to list user login sessions, their start and end times, and associated terminal devices. The option `--supp-groups` is used to display the groups of each user in addition to the standard output. This means that along with the usual information like username, login time, and hostname, this command will also show the primary and secondary groups for each logged-in user.'
        system-accs: '[AI] `lslogins --system-accs` is a Linux command used to list the system accounts that have been used to log into the system via the System Log-in (syslog) facility. The `--system-accs` option filters the output to only show the system accounts, excluding user accounts. The output displays the username, hostname or IP address, and the login timestamp for each system login event.'
        time-format: '[AI] The `lslogins` command with the option `--time-format` is used to list the system logins and display the login times in a specified format. The default time format is "%b %d %H:%M", which displays the month, day, and hour in minutes of the login. However, by specifying a custom time format using `--time-format`, you can change how the login times are displayed. For example, `--time-format="+%Y-%m-%d %H:%M:%S"` would display the year, month, day, hour, minute, and second.'
        user-accs: '[AI] `lslogins` is a command in Unix-like operating systems that lists the last login times for each user account on the system. The option `--user-accs` or `-U` specifies that only the username portion of the output should be displayed, without showing the corresponding UID or TTY device information. In summary, using `lslogins --user-accs` will display a list of usernames with their last login information.'
        version: '[AI] `lslogins` is a command-line utility in Unix and Linux systems used to list the login sessions for users based on logs, specifically the `/var/log/wtmp` or `/var/run/utmp` file. The `--version` option is used to display the version information of this particular `lslogins` command, including its name, release, version number, and copyright information. It provides users with the ability to check which version of `lslogins` they have installed on their system for troubleshooting or compatibility purposes.'
        wtmp-file: '[AI] `lslogins` is a Linux command used to display the login records stored in the system''s WTMP (Watchful Tape File) or WTS (Who''s There) file. The `--wtmp-file` option specifies the name of the WTMP file to be used, which by default is usually located at /var/log/wtmp. This command provides information on who logged in and out of the system, their username, the type of terminal or device they used, and the login timestamp. It helps system administrators monitor and investigate user activities and security events related to system access.'

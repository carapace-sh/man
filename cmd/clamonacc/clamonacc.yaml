# yaml-language-server: $schema=https://carapace.sh/schemas/command.json
name: clamonacc
description: an anti-virus on-access scanning daemon and clamd client
flags:
    --copy=: Copy infected files into DIRECTORY
    --fdpass: Pass filedescriptor to clamd (useful if clamd is running as a different user)
    --move=: Move infected files into DIRECTORY
    --remove: Remove infected files. Be careful!
    --stream: Force streaming files to clamd (for debugging and unit testing)
    -F, --foreground: Output to foreground and do not daemonize
    -V, --version: Print version number and exit
    -W, --watch-list=: Watch directories from FILE
    -c, --config-file=: Read configuration from FILE
    -e, --exclude-list=: Exclude directories from FILE
    -h, --help: Show this help
    -l, --log=: Save scanning output to FILE
    -p, --ping: ']    Ping clamd up to [A] times at optional interval [I] until it responds.'
    -v, --verbose: Be verbose
    -w, --wait: Wait up to 30 seconds for clamd to start. Optionally use alongside --ping to set attempts [A] and interval [I] to check clamd.
    -z, --allmatch: Continue scanning within file after finding a match.
documentation:
    command: |-
        [AI] `clamwinmal` or `clamonscan` is a command-line tool used in ClamAV, an open-source antivirus engine. The specific command `clamonacc` doesn't exist; however, there are two related commands:

        1. `clamscan`: Scans individual files or directories for viruses and other malware. It can run in various modes such as quick scan (fast scanning of file metadata), full scan (detailed scanning of file contents), or heuristic scan (analysis based on behavior patterns).

        2. `clamwinmal`: A graphical user interface (GUI) version of ClamAV scanner, specifically designed for Windows systems. It provides an easy-to-use interface to manage and monitor scans, with the ability to queue multiple files or directories for scanning. The term "clamonacc" is likely a typo or misinterpretation, as there's no such command in ClamAV.
    flag:
        allmatch: '[AI] `clamscan` is a command-line antivirus tool from ClamAV. The option `--allmatches` is used to show all the matched virus signatures instead of just stopping at the first match found during a scan. When used with the command `clamscan`, it will display all the detected viruses or threats in a file or directory, providing a more comprehensive report.'
        config-file: '[AI] The `clamwin` or `clamav` antivirus software''s `clamscan` command with the option `--config-file` is used to specify a custom configuration file for ClamAV scanner rules and databases. This allows users to override default settings or add new rules not included in the standard distribution. The specified file should be in the YAML format, and it may contain various directives such as specifying custom database locations, enabling or disabling specific signatures, setting logging options, and more.'
        copy: '[AI] The `clamav` command `--copy` flag is used when scanning files for viruses or malware with ClamAV antivirus software. This flag instructs ClamAV to copy any scanned file that is detected as infected to a quarantine directory, instead of deleting it directly. This allows administrators to review and handle the suspected files manually before taking further action.'
        exclude-list: '[AI] The `clamav` command-line tool `clamscan` has an option named `--exclude-list`. This option is used to specify a file that contains a list of file paths or regular expressions, which will be excluded from the antivirus scan performed by the `clamscan` tool. By excluding certain files or directories from the scan, you can improve scanning performance and reduce false positives. The excluded files or directories are not scanned during the antivirus scan, allowing you to focus on critical areas and save resources.'
        fdpass: '[AI] `clamav` is a popular open-source antivirus engine used in various security solutions. The option `--fdpass` is a flag for the ClamAV Scanner command-line tool `clamscan`. It enables the scanning of files and directories using an external file descriptor passthrough, allowing large files or entire directories to be scanned without having to read the entire data into memory. This flag facilitates more efficient scanning of massive datasets or systems with limited resources.'
        foreground: '[AI] The `clamav` command-line tool, specifically the `clamscan` or `freshclam` utilities, is used for scanning files and directories for viruses using ClamAV antivirus engine. The option `--foreground` is passed to these commands when you want them to run in the current terminal session, as opposed to running in the background. This means that the scan will provide real-time output and progress indicators, allowing you to interact with the console while it''s scanning. It doesn''t affect the behavior of ClamAV engine itself, just how its output is presented.'
        help: '[AI] "clamav-unclamd" is a daemon (background process) in ClamAV antivirus software that scans files in real time as they are accessed. The command "clamscan --help" displays the help information for the clamscan utility, which is used to perform manual file scans. The command "clamav --help" or specifically "clamav-unclamd --help" would display the help information for the ClamAV daemon itself, explaining how to install, configure, and manage it. However, without specifying a particular ClamAV implementation or version, it''s impossible to provide an exact explanation of the flag "clamonacc --help". This command is not a recognized option for any known ClamAV tool.'
        log: '[AI] The `clamav` command-line tool, specifically the `clamscan` or `freshclam` subcommands with the option `--log`, generates detailed logs during antivirus scanning activities. This logging feature helps in troubleshooting, understanding the scan progression and results, and identifying any potential issues related to malware detection. The logged information includes details such as file paths, scan statuses, detected threats, and error messages if any errors occur during the scan.'
        move: '[AI] The `clamonacc` command is a tool from the Accelerated Data Processing (ADP) framework in Cloudera''s Hadoop distribution. The specific command `--move` is used to move data between different storage locations or nodes within ADP. When you run `clamonacc --move`, it initiates an operation to transfer data while keeping the metadata and statistics updated, ensuring data consistency. The source and destination paths are provided as arguments for this command.'
        ping: '[AI] The `clamwin` or `clamav` antivirus tool, specifically its command-line scanner named `clamscan`, has a subcommand called `--ping`. This option is used to test the connection to a remote ClamAV virus definition server over the network. It sends an UDP packet to the specified server address and port number (default is 3128) and returns the response time, indicating if the connection is successful or not. This can be useful for troubleshooting connectivity issues when using online virus definitions in a ClamAV installation.'
        remove: '[AI] `clamav --remove` is a command-line utility for ClamAV, an open-source antivirus engine. It''s used to delete files that have previously been detected as viruses or malware by ClamAV. When you run this command followed by the file path, ClamAV scans the file and if it detects a threat, the file is deleted permanently without moving it to a quarantine location.'
        stream: '[AI] `clamav --stream` is a command-line utility from Clam Antivirus, an open-source antivirus engine used for scanning files and archives. The `--stream` option is used to scan data as it is being passed through a pipe or socket without writing the file to disk first. This mode is useful when dealing with large files or data streams where disk I/O might be a bottleneck. Instead, the data is read directly from the input source and scanned in real-time. The results are then displayed on the console, which makes it efficient for handling large volumes of data.'
        verbose: '[AI] "clamav-unpack" is a tool from ClamAV antivirus software used to extract and scan archives for viruses or malware. The command "clamavan-unpack --verbose" instructs the tool to run in verbose mode, which means it will provide detailed information about the unpacking and scanning process including filenames and scan results.'
        version: '[AI] `clamav --version` is a command used in Unix-based systems to check the version information of Clam AntiVirus, an open-source antivirus engine for detecting trojans, viruses, malware etc. When executed, it returns output displaying the ClamAV version number, compilation options and other relevant details.'
        wait: '[AI] `clamav --wait` is a command-line option for ClamAV, an open-source antivirus software. It tells the clamscan virus scanner to run in real-time mode and pause the scan if it detects a potential threat, waiting for user confirmation before proceeding with further actions. This can help prevent false positives and ensure that potentially harmful files are not inadvertently quarantined or deleted.'
        watch-list: '[AI] The `clamonacc` is a command-line tool used for analyzing network traffic with the Bro IDS platform. The option `--watch-list` is used to specify a file containing IP addresses or hostnames that ClamAV, an antivirus engine integrated into Bro, should monitor. When `clamonacc` processes network traffic, it checks the data against the list of monitored IPs/hosts and generates alerts if any suspicious activity is detected.'

# yaml-language-server: $schema=https://carapace.sh/schemas/command.json
name: prune
description: Remove unneeded data from the repository
flags:
    --max-repack-size=: 'maximum `size` to repack (allowed suffixes: k/K, m/M, g/G, t/T)'
    --max-unused=: tolerate given `limit` of unused data (absolute value in bytes with suffixes k/K, m/M, g/G, t/T, a value in % or the word 'unlimited')
    --repack-cacheable-only: only repack packs which are cacheable
    -n, --dry-run: do not modify the repository, just print what would be done
documentation:
    command: '[AI] `restic prune` is a command from the backup tool Restic. It''s used to remove old, backed-up data that is no longer needed based on specific retention policies. With this command, you can choose to delete backups older than a certain age or keep only a specified number of revisions. Pruning helps manage storage space and maintain an efficient backup system.'
    flag:
        dry-run: '[AI] `restic prune --dry-run` is a command used in the backup tool, `restic`. This command initiates a dry run of the `prune` operation. The `prune` function is responsible for removing old snapshots that no longer have retention. With the `--dry-run` flag, restic will simulate the pruning process and display what would be deleted without actually executing any deletions. This helps users understand the impact of the command before applying it to their actual backups.'
        max-repack-size: '[AI] The `restic prune --max-repack-size` command is used in the data backup and sync tool, restic. This command helps manage the repository by deleting old snapshots that no longer need to be kept based on the configured retention policy. The `--max-repack-size` option sets a limit for the size of repack operations during pruning. Repack operations are used to optimize and reduce the size of the repository by reorganizing data, so setting a maximum size helps prevent long-running or failed operations and keeps the repository manageable.'
        max-unused: '[AI] `restic prune --max-unused` is a command in the backup tool, `restic`. This command helps manage old and unused data in your backups to save storage space. The `--max-unused` option sets a threshold for how long data can be unused before it gets deleted. When run, restic identifies data that has not been referenced by any snapshot or archive for more than the specified time and marks it as candidate for deletion. However, it does not delete the data right away. Instead, it waits for a subsequent `restic prune` command to actually delete the data if no snapshots or archives reference it after that. The goal is to minimize the risk of unintentionally deleting important data.'
        repack-cacheable-only: '[AI] The `restic prune --repack-cacheable-only` command is used in the backup tool `restic` to delete old snapshot data from the cache that is no longer needed and can be safely repackaged. This flag specifically tells restic to only process cacheable snapshots, which are those that have all their objects stored in external repositories and not just in memory or local disk. The result of this command is a more efficient use of cache resources and reduced storage usage without affecting the retention policy or data integrity of the backups.'
